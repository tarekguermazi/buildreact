(this["webpackJsonpapp-frontend"]=this["webpackJsonpapp-frontend"]||[]).push([[24],{614:function(e,t,n){"use strict";var a=n(25),c=n(30),r=n(36),s=n.n(r),i=n(5),o=n.n(i),u=n(37),l=["bsPrefix","className","noGutters","as"],d=["xl","lg","md","sm","xs"],b=o.a.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,i=e.noGutters,b=e.as,j=void 0===b?"div":b,m=Object(c.a)(e,l),f=Object(u.a)(n,"row"),p=f+"-cols",O=[];return d.forEach((function(e){var t,n=m[e];delete m[e];var a="xs"!==e?"-"+e:"";null!=(t=null!=n&&"object"===typeof n?n.cols:n)&&O.push(""+p+a+"-"+t)})),o.a.createElement(j,Object(a.a)({ref:t},m,{className:s.a.apply(void 0,[r,f,i&&"no-gutters"].concat(O))}))}));b.displayName="Row",b.defaultProps={noGutters:!1},t.a=b},615:function(e,t,n){"use strict";var a=n(25),c=n(30),r=n(36),s=n.n(r),i=n(5),o=n.n(i),u=n(37),l=["bsPrefix","className","as"],d=["xl","lg","md","sm","xs"],b=o.a.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,i=e.as,b=void 0===i?"div":i,j=Object(c.a)(e,l),m=Object(u.a)(n,"col"),f=[],p=[];return d.forEach((function(e){var t,n,a,c=j[e];if(delete j[e],"object"===typeof c&&null!=c){var r=c.span;t=void 0===r||r,n=c.offset,a=c.order}else t=c;var s="xs"!==e?"-"+e:"";t&&f.push(!0===t?""+m+s:""+m+s+"-"+t),null!=a&&p.push("order"+s+"-"+a),null!=n&&p.push("offset"+s+"-"+n)})),f.length||f.push(m),o.a.createElement(b,Object(a.a)({},j,{ref:t,className:s.a.apply(void 0,[r].concat(f,p))}))}));b.displayName="Col",t.a=b},628:function(e,t,n){"use strict";n(694),n(146),n(695),n(659),n(38);var a=n(648),c=n(649),r=(n(22),n(653)),s=n(650),i=n(651),o=n(5),u=n.n(o),l=n(684),d=n(681),b=(n(121),n(698),n(619)),j=(n(675),n(699),n(683),n(700)),m=n(693);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(i.a)(e);if(t){var c=Object(i.a)(this).constructor;n=Reflect.construct(a,arguments,c)}else n=a.apply(this,arguments);return Object(s.a)(this,n)}}o.Component;var p=Object(j.a)(b.a);t.a=p},659:function(e,t,n){var a=n(660),c=n(661),r=n(696),s=n(662);e.exports=function(e){return a(e)||c(e)||r(e)||s()}},660:function(e,t,n){var a=n(697);e.exports=function(e){if(Array.isArray(e))return a(e)}},661:function(e,t){e.exports=function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},662:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},691:function(e,t,n){"use strict";var a=n(4),c=n(29),r=n(57),s=n(129),i=Object(a.a)([c.a.selectCurrentTenant,c.a.selectCurrentUser],(function(e,t){return new r.a(e,t).match(s.a.values.produitRead)})),o=Object(a.a)([c.a.selectCurrentTenant,c.a.selectCurrentUser],(function(e,t){return new r.a(e,t).match(s.a.values.produitEdit)})),u=Object(a.a)([c.a.selectCurrentTenant,c.a.selectCurrentUser],(function(e,t){return new r.a(e,t).match(s.a.values.produitCreate)})),l=Object(a.a)([c.a.selectCurrentTenant,c.a.selectCurrentUser],(function(e,t){return new r.a(e,t).match(s.a.values.produitImport)})),d={selectPermissionToRead:i,selectPermissionToEdit:o,selectPermissionToCreate:u,selectPermissionToDestroy:Object(a.a)([c.a.selectCurrentTenant,c.a.selectCurrentUser],(function(e,t){return new r.a(e,t).match(s.a.values.produitDestroy)})),selectPermissionToImport:l};t.a=d},753:function(e,t,n){"use strict";var a=n(0),c=n(19),r=n(145),s=n(11),i=n(5),o=n(68),u=n(1),l=n.n(u),d=n(3),b=n(121),j=n.n(b),m=n(2),f=n(6),p=n(745);var O=function(e){var t=Object(i.useRef)(),n=Object(i.useState)(!1),a=Object(r.a)(n,2),c=a[0],u=a[1];Object(i.useEffect)((function(){window.$(t.current).modal("show"),window.$(t.current).on("hidden.bs.modal",e.onClose)}),[]);var b=function(){var n=Object(d.a)(l.a.mark((function n(a,c){var r,s,i;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,u(!0),n.next=4,o.a.create(c);case 4:return r=n.sent,s=r.id,n.next=8,o.a.find(s);case 8:i=n.sent,window.$(t.current).modal("hide"),e.onSuccess(i),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(0),f.a.handle(n.t0);case 16:return n.prev=16,u(!1),n.finish(16);case 19:case"end":return n.stop()}}),n,null,[[0,13,16,19]])})));return function(e,t){return n.apply(this,arguments)}}();return j.a.createPortal(Object(s.jsx)("div",{ref:t,className:"modal",tabIndex:-1,children:Object(s.jsx)("div",{className:"modal-dialog modal-lg",children:Object(s.jsxs)("div",{className:"modal-content",children:[Object(s.jsxs)("div",{className:"modal-header",children:[Object(s.jsx)("h5",{className:"modal-title",children:Object(m.c)("entities.produit.new.title")}),Object(s.jsx)("button",{type:"button",className:"close","data-dismiss":"modal",children:Object(s.jsx)("span",{children:"\xd7"})})]}),Object(s.jsx)("div",{className:"modal-body",children:Object(s.jsx)(p.a,{saveLoading:c,onSubmit:b,onCancel:function(){window.$(t.current).modal("hide")},modal:!0})})]})})}),document.getElementById("modal-root"))},x=n(624),h=n(606),v=n(35),g=n(691);t.a=function(e){var t=Object(h.d)(),n=t.setValue,u=t.getValues,l=Object(i.useState)(!1),d=Object(r.a)(l,2),b=d[0],j=d[1],m=Object(v.e)(g.a.selectPermissionToCreate),f=function(){j(!1)},p={toAutocomplete(e){if(!e)return null;var t=e.id,n=e.label,a=e.prix,c=e.stock,r=e.titre;return e.titre&&(n=e.titre,a=e.prix,c=e.stock,r=e.titre),{key:t,value:t,label:n,prix:a,stock:c,titre:r}},toValue:e=>e?{id:e.value,label:e.label,prix:e.prix,stock:e.stock,titre:e.titre}:null};return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(x.a,Object(a.a)(Object(a.a)({},e),{},{fetchFn:function(e,t){return o.a.listAutocomplete(e,t)},mapper:p,onOpenModal:function(){j(!0)},hasPermissionToCreate:m})),b&&Object(s.jsx)(O,{onClose:f,onSuccess:function(t){var a=e.name,r=e.mode;n(a,r&&"multiple"===r?[].concat(Object(c.a)(u()[a]||[]),[t]):t),f()}})]})}},792:function(e,t,n){"use strict";var a=n(0),c=n(145),r=n(11),s=n(5),i=n(606),o=n(2),u=n(616),l=n(607),d=n(620),b=n(39),j=n(618),m=n(654),f=n(753),p=n(613),O=n(614),x=n(615),h=n(802),v=b.e().shape({product:u.a.relationToOne(Object(o.c)("entities.commandLine.fields.product"),{required:!0}),quantity:u.a.integer(Object(o.c)("entities.commandLine.fields.quantity"),{required:!0,min:1,max:undefined}),subTotal:u.a.integer(Object(o.c)("entities.commandLine.fields.subTotal"),{required:!0}),productTitle:u.a.string(Object(o.c)("entities.commandLine.fields.productTitle"),{required:!0})});t.a=function(e){var t=Object(s.useState)(!1),n=Object(c.a)(t,2),u=n[0],b=n[1],g=Object(s.useState)((function(){var t=e.record||{};return{product:t.product,quantity:t.quantity,subTotal:t.subTotal,productTitle:t.productTitle}})),y=Object(c.a)(g,1)[0],V=Object(i.c)({resolver:Object(j.yupResolver)(v),mode:"all",defaultValues:y}),C=function(t){var n;if(V.getValues().product&&V.getValues().product.stock)V.getValues().quantity<=V.getValues().product.stock?e.onSubmit(null===(n=e.record)||void 0===n?void 0:n.id,t):b(!0);else if(V.getValues().product&&!V.getValues().product.stock){var a;e.onSubmit(null===(a=e.record)||void 0===a?void 0:a.id,t)}else console.log("error")};return Object(r.jsx)(d.a,{children:Object(r.jsx)(i.a,Object(a.a)(Object(a.a)({},V),{},{children:Object(r.jsxs)("form",{onSubmit:V.handleSubmit(C),children:[V.getValues().product?Object(r.jsx)(O.a,{children:Object(r.jsx)(x.a,{sm:8,style:{display:"none"},children:Object(r.jsx)(p.a,{name:"productTitle",label:Object(o.c)("entities.produit.fields.titre"),defaultValue:V.getValues().product.titre})})}):null,Object(r.jsxs)(O.a,{children:[Object(r.jsx)(x.a,{sm:8,children:Object(r.jsx)(f.a,{name:"product",label:Object(o.c)("entities.commandLine.fields.product"),required:!0,showCreate:!e.modal})}),Object(r.jsx)(x.a,{sm:4,children:V.getValues().product?Object(r.jsx)(m.a,{name:V.getValues().product.prix,defaultValue:V.getValues().product.prix+"",label:Object(o.c)("entities.produit.fields.prix"),required:!0,disabled:!0}):null})]}),Object(r.jsxs)(O.a,{children:[V.getValues().product&&V.getValues().product.stock?Object(r.jsxs)(x.a,{sm:4,children:[Object(r.jsx)(m.a,{name:"quantity",label:Object(o.c)("entities.commandLine.fields.quantity"),required:!0,maxValue:V.getValues().product.stock,type:"number"}),u?Object(r.jsx)(h.a,{variant:"danger",onClose:function(){return b(!1)},dismissible:!0,children:Object(r.jsx)("p",{children:Object(o.c)("common.quantityError")})}):null]}):Object(r.jsx)(x.a,{sm:4,children:Object(r.jsx)(m.a,{name:"quantity",label:Object(o.c)("entities.commandLine.fields.quantity"),required:!0,type:"number"})}),V.getValues().product?Object(r.jsx)(x.a,{sm:4,children:V.getValues().product.stock?Object(r.jsx)(p.a,{name:"stock",label:Object(o.c)("entities.produit.fields.stock"),defaultValue:V.getValues().product.stock}):null}):null,Object(r.jsx)(x.a,{sm:4,children:V.getValues().product&&V.getValues().quantity?Object(r.jsx)(m.a,{name:"subTotal",defaultValue:V.getValues().product.prix*V.getValues().quantity+"",label:Object(o.c)("entities.commandLine.fields.subTotal"),required:!0}):null})]}),Object(r.jsxs)("div",{className:"form-buttons",children:[Object(r.jsxs)("button",{className:"btn btn-primary",disabled:e.saveLoading,type:"button",onClick:V.handleSubmit(C),children:[Object(r.jsx)(l.a,{loading:e.saveLoading,iconClass:"far fa-save"})," ",Object(o.c)("common.save")]}),Object(r.jsxs)("button",{className:"btn btn-light",type:"button",disabled:e.saveLoading,onClick:function(){Object.keys(y).forEach((function(e){V.setValue(e,y[e])}))},children:[Object(r.jsx)("i",{className:"fas fa-undo"})," ",Object(o.c)("common.reset")]}),e.onCancel?Object(r.jsxs)("button",{className:"btn btn-light",type:"button",disabled:e.saveLoading,onClick:function(){return e.onCancel()},children:[Object(r.jsx)("i",{className:"fas fa-times"})," ",Object(o.c)("common.cancel")]}):null]})]})}))})}},902:function(e,t,n){"use strict";n.r(t);var a=n(145),c=n(11),r=n(5),s=n(35),i=n(32),o=n(2),u=n(120),l=n(4),d=function(e){return e.commandLine.form},b=Object(l.a)([d],(function(e){return e.record})),j={selectInitLoading:Object(l.a)([d],(function(e){return Boolean(e.initLoading)})),selectSaveLoading:Object(l.a)([d],(function(e){return Boolean(e.saveLoading)})),selectRecord:b,selectRaw:d},m=n(7),f=n(792),p=n(609),O=n(611),x=n(612),h=n(610);t.default=function(e){var t=Object(r.useState)(!1),n=Object(a.a)(t,2),l=n[0],d=n[1],b=Object(s.d)(),v=Object(i.h)(),g=Object(s.e)(j.selectInitLoading),y=Object(s.e)(j.selectSaveLoading),V=Object(s.e)(j.selectRecord),C=Boolean(v.params.id),w=C?Object(o.c)("entities.commandLine.edit.title"):Object(o.c)("entities.commandLine.new.title");return Object(r.useEffect)((function(){b(u.a.doInit(v.params.id)),d(!0)}),[b,v.params.id]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(O.a,{items:[[Object(o.c)("dashboard.menu"),"/"],[Object(o.c)("entities.commandLine.menu")],[w]]}),Object(c.jsxs)(p.a,{children:[Object(c.jsx)(h.a,{children:w}),g&&Object(c.jsx)(x.a,{}),l&&!g&&Object(c.jsx)(f.a,{saveLoading:y,initLoading:g,record:V,isEditing:C,onSubmit:function(e,t){b(C?u.a.doUpdate(e,t):u.a.doCreate(t))},onCancel:function(){return Object(m.b)().goBack()}})]})]})}}}]);